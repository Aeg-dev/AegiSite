<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://aeg-dev.github.io/AegiSite/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://aeg-dev.github.io/AegiSite/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://aeg-dev.github.io/AegiSite/main.fa2ec43ae1b847039e1d1361782f0c3426397729912cb579510777745c5642a5253898bb2423a0355e7a1a0b5e3076f5ecd4630445de5c4a51a7b65253a95460.css integrity="sha512-+i7EOuG4RwOeHRNheC8MNCY5dymRLLV5UQd3dFxWQqUlOJi7JCOgNV56GgteMHb17NRjBEXeXEpRp7ZSU6lUYA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Lua Reference - Aegisub</title><meta name=description content="Aegisub is a free, cross-platform open source tool for creating and modifying subtitles. Aegisub makes it quick and easy to time subtitles to audio, and features many powerful tools for styling them, including a built-in real-time video preview."><link rel=canonical href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/doks.png"><meta name=twitter:title content="Lua Reference"><meta name=twitter:description content="The Automation 4 Lua scripting engine is based on the version 5.1 series of the Lua scripting language.
This manual will not deal with the Lua language itself nor the standard libraries shipping with Lua, but only the additional functions and data structures provided by the Aegisub Automation 4 Lua interface. Please see the Lua 5.1 manual for details on the language itself and its standard libraries.
General overview of the organisation of Automation 4 Lua The smallest legal Automation 4 Lua script is an empty file, but that won&rsquo;t be able to do anything interesting."><meta name=twitter:site content="@henkverlinde"><meta name=twitter:creator content="@henkverlinde"><meta property="og:title" content="Lua Reference"><meta property="og:description" content="The Automation 4 Lua scripting engine is based on the version 5.1 series of the Lua scripting language.
This manual will not deal with the Lua language itself nor the standard libraries shipping with Lua, but only the additional functions and data structures provided by the Aegisub Automation 4 Lua interface. Please see the Lua 5.1 manual for details on the language itself and its standard libraries.
General overview of the organisation of Automation 4 Lua The smallest legal Automation 4 Lua script is an empty file, but that won&rsquo;t be able to do anything interesting."><meta property="og:type" content="article"><meta property="og:url" content="/docs/3.2/automation/lua/"><meta property="og:image" content="/doks.png"><meta property="og:site_name" content="Aegisub"><meta property="article:publisher" content="https://www.facebook.com/verlinde.henk"><meta property="article:author" content="https://www.facebook.com/verlinde.henk"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/aeg-dev.github.io\/AegiSite\/"},{"@type":"ListItem","position":3,"name":"Docs","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/"},{"@type":"ListItem","position":4,"name":"3.2","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/"},{"@type":"ListItem","position":5,"name":"Automation","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/automation\/"},{"@type":"ListItem","position":6,"name":"Lua","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/automation\/lua\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://aeg-dev.github.io/AegiSite/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aeg-dev.github.io/AegiSite/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aeg-dev.github.io/AegiSite/favicon-16x16.png><link rel=manifest href=https://aeg-dev.github.io/AegiSite/site.webmanifest><meta http-equiv=refresh content="0; url=https://aegisub.org//docs/latest/automation/lua/"></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://aeg-dev.github.io/AegiSite/>Aegisub</a><div class="order-1 order-md-3"><div class=input-group><select class=custom-select id=inputGroupSelect-language-switching onchange="location=this.value"><option id=en value=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/ selected>English</option><option id=zh-cn value=https://aeg-dev.github.io/AegiSite/zh-cn/docs/3.2/automation/lua/>简体中文</option></select></div></div><button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/Aegisub/Aegisub><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2 text-nowrap"><li class=nav-item><a class=nav-link href=https://aeg-dev.github.io/AegiSite/downloads/main/>Downloads</a></li><li class="nav-item active"><a class=nav-link href=https://aeg-dev.github.io/AegiSite/docs/>Docs</a></li><li class=nav-item><a class=nav-link href=https://github.com/Aegisub/Aegisub/issues>Bug Tracker</a></li><li class=nav-item><a class=nav-link href=https://aeg-dev.github.io/AegiSite/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=http://blog.aegisub.org/>Old News</a></li></ul><div class="break order-6 d-md-none"></div></div></div></header><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Navigation</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/main_page/>Main Page</a></li></ul><h3>Introduction</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/about/>What is Aegisub?</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/highlights/>Highlights</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/credits/>Credits</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/support/>Support Aegisub</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/faq/>FAQ</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/tutorials/>Tutorials</a></li></ul><h3>Working with Subtitles</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/editing_subtitles/>Editing Subtitles</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/exporting/>Exporting Subtitles</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/attaching_subtitles_to_video/>Applying Subtitles</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/spell_checker/>Spell Checker</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/translation_assistant/>Translation Assistant</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/paste_over/>Paste Over</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/select_lines/>Select Lines</a></li></ul><h3>Typesetting</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/typesetting/>Typesetting Introduction</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/video/>Working with Video</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/styles/>Editing styles</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/visual_typesetting/>Visual Typesetting</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/ass_tags/>ASS Override Tags</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/colour_picker/>Colour Picker</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/styling_assistant/>Styling Assistant</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/resolution_resampler/>Resolution Resampler</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/fonts_collector/>Fonts Collector</a></li></ul><h3>Timing</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/audio/>Working with Audio</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/timing/>Timing subtitles to audio</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/shift_times/>Shift times</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/timing_post-processor/>Timing Post-Processor</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/kanji_timer/>Kanji Timer</a></li></ul><h3>Automation</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/>Overview</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/karaoke_templater/>Karaoke Templater</a></li><li><a class="docs-link active" href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/>Lua Reference</a></li></ul><h3>Miscellaneous</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/options/>Aegisub Options</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/properties/>Script Properties</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/attachment_manager/>Attachment Manager</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/commands/>Commands</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#general-overview-of-the-organisation-of-automation-4-lua>General overview of the organisation of Automation 4 Lua</a></li><li><a href=#the-automation-4-lua-core-api>The Automation 4 Lua core API</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Lua Reference</h1><p class=lead></p><p>The Automation 4 Lua scripting engine is based on the version 5.1 series of
<a href=http://www.lua.org>the Lua scripting language</a>.</p><p>This manual will not deal with the Lua language itself nor the standard
libraries shipping with Lua, but only the additional functions and data
structures provided by the Aegisub Automation 4 Lua interface. Please see
<a href=http://www.lua.org/manual/5.1/>the Lua 5.1 manual</a> for details on the
language itself and its standard libraries.</p><h2 id=general-overview-of-the-organisation-of-automation-4-lua>General overview of the organisation of Automation 4 Lua<a href=#general-overview-of-the-organisation-of-automation-4-lua class=anchor aria-hidden=true>#</a></h2><p>The smallest legal Automation 4 Lua script is an empty file, but that won&rsquo;t
be able to do anything interesting.</p><p>There&rsquo;s a number of global variables a script can set to provide
information about itself. This information will be displayed in the
<a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/manager/>Automation/Manager</a> window: <code>script_name</code>, <code>script_description</code>,
<code>script_author</code> and <code>script_version</code>.</p><p>Automation 4 Lua implements both of the currently defined &ldquo;features&rdquo; of
Automation 4: Macro and Export Filter. One script (one file) can define
zero, one or many of each of those features. For example, the Karaoke
Templater script defines one macro and one export filter.</p><p>When an Automation 4 Lua script is loaded, its top-level code is executed
once. You can put variable initialisations and such at the top level, but
what you usually will do is define some of the script information globals,
import some modules, write some functions that do the script&rsquo;s work and
then call the feature registration functions. This is described on the
<strong><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/registration/>Registration</a></strong> page. The only fields of the
<code>aegisub</code> object that should be touched during script loading are
<code>lua_automation_version</code> and the registration functions. Most others will
simply do nothing and return <code>nil</code>.</p><p>When the user activates a feature from the Aegisub interface (such as by
selecting a macro from the Automation menu) the registered script function
is run. One of the parameters passed to the function is a <em>subtitles
object</em>, the primary interface to the subtitle data the script will
manipulate. To some extent, the subtitles object works as an
integer-indexed array, but it exposes some special interfaces to add,
remove and modify subtitle lines. The subtitles object allows you to access
every line in the subtitle file, including headers, style definitions,
dialogue lines and comment lines. This is described on the <strong><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/subtitle_file_interface/>Subtitle file interface</a></strong> page.</p><p>Automation 4 Lua also provides a number of helper functions in the core API
for getting information on e.g. the video frame timestamps and how large a
piece of text will be when rendered with a given style.</p><p>Most things that can be implemented in clean Lua code, i.e. that don&rsquo;t
depend directly on Aegisub internal data structures, have been implemented
outside the core API as <a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/modules/>Lua modules</a>. While it is possible to write
Automation 4 Lua scripts without using the provided standard include files
you will find that for anything but the simplest scripts you will need some
of the functions provided by the includes.</p><h2 id=the-automation-4-lua-core-api>The Automation 4 Lua core API<a href=#the-automation-4-lua-core-api class=anchor aria-hidden=true>#</a></h2><p>Automation 4 Lua provides various APIs that can be grouped in these general
categories.</p><dl><dt><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/registration/>Script and feature registration</a></dt><dd>Deals with advertising what features a script provides and a few other
script meta data.</dd><dt><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/subtitle_file_interface/>Subtitle file interface</a></dt><dd>Deals with use of the <em>subtitles</em> object, the principal way of accessing
and modifying the subtitle data.</dd><dt><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/progress_reporting/>Progress reporting and debug output</a></dt><dd>providing feedback to the user while a script is running, outputting
hints and warnings to the user and printing debug information.</dd><dt><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/dialogs/>Displaying dialogue boxes and getting user input</a></dt><dd>requesting user input during macro execution by dialogue boxes and
providing a configuration interface for export filters.</dd><dt><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/lua/miscellaneous_apis/>Miscellaneous APIs</a></dt><dd>for e.g. getting the rendered size of text and getting video frame rate
information.</dd></dl><p>{::template name=&ldquo;automation_navbox&rdquo; /}</p><div class="docs-navigation d-flex justify-content-between"><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/automation/karaoke_templater/><div class="card my-1"><div class="card-body py-2">&larr; Karaoke Templater</div></div></a><a class=ms-auto href=https://aeg-dev.github.io/AegiSite/docs/3.2/options/><div class="card my-1"><div class="card-body py-2">Aegisub Options &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://www.networkredux.com/>NetworkRedux</a>, <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=https://aeg-dev.github.io/AegiSite/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=https://aeg-dev.github.io/AegiSite/js/highlight.min.f80b63ab0a29882dba84d0df18b9afe2e098d916b22007769c8fab9ba080a0b96a6d6c87bff561e64a9b5dde421d934ffe8aee085500f18d8aa183c6294e72bd.js integrity="sha512-+AtjqwopiC26hNDfGLmv4uCY2RayIAd2nI+rm6CAoLlqbWyHv/Vh5kqbXd5CHZNP/oruCFUA8Y2KoYPGKU5yvQ==" crossorigin=anonymous defer></script>
<script src=https://aeg-dev.github.io/AegiSite/main.min.12763ab77eb1a8341afa7dfe9efaa3762a502b8e20262a7bcd0e713140eb441763122246616148895d4dd3da0e15f060137eb3b9334894fa4c74ebec6dc576b0.js integrity="sha512-EnY6t36xqDQa+n3+nvqjdipQK44gJip7zQ5xMUDrRBdjEiJGYWFIiV1N09oOFfBgE36zuTNIlPpMdOvsbcV2sA==" crossorigin=anonymous defer></script></body></html>