<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://aeg-dev.github.io/AegiSite/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://aeg-dev.github.io/AegiSite/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://aeg-dev.github.io/AegiSite/main.569569a1e015e4f3bc7712f044c9f89bcb53f94c8171f6c68b4bf3f48750e955d2fafceda6e7e8afd0b9e26e60a2e4c8fde6fab574d7047d87e2e4005aa21c58.css integrity="sha512-VpVpoeAV5PO8dxLwRMn4m8tT+UyBcfbGi0vz9IdQ6VXS+vztpufor9C54m5gouTI/eb6tXTXBH2H4uQAWqIcWA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>- Aegisub</title><meta name=description content="Aegisub is a free, cross-platform open source tool for creating and modifying subtitles. Aegisub makes it quick and easy to time subtitles to audio, and features many powerful tools for styling them, including a built-in real-time video preview."><link rel=canonical href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/automation/lua/miscellaneous_apis/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/doks.png"><meta name=twitter:title content><meta name=twitter:description content="This page documents miscellaneous APIs useful for working with subtitles. These can&rsquo;t be clearly placed into any of the other main categories and there&rsquo;s too few of each kind to warrant a separate category.
aegisub.cancel Synopsis: aegisub.cancel()
Immediately end execution of the current script, rolling back any changes that have been made in it.
This function never returns.
aegisub.text_extents Synopsis: width, height, descent, ext_lead = aegisub.text_extents(style, text)
Obtain system font metrics and determine the rendered size in pixels of the given text when using the style."><meta name=twitter:site content="@henkverlinde"><meta name=twitter:creator content="@henkverlinde"><meta property="og:title" content><meta property="og:description" content="This page documents miscellaneous APIs useful for working with subtitles. These can&rsquo;t be clearly placed into any of the other main categories and there&rsquo;s too few of each kind to warrant a separate category.
aegisub.cancel Synopsis: aegisub.cancel()
Immediately end execution of the current script, rolling back any changes that have been made in it.
This function never returns.
aegisub.text_extents Synopsis: width, height, descent, ext_lead = aegisub.text_extents(style, text)
Obtain system font metrics and determine the rendered size in pixels of the given text when using the style."><meta property="og:type" content="article"><meta property="og:url" content="/docs/3.2/en/automation/lua/miscellaneous_apis/"><meta property="og:image" content="/doks.png"><meta property="og:site_name" content="Aegisub"><meta property="article:publisher" content="https://www.facebook.com/verlinde.henk"><meta property="article:author" content="https://www.facebook.com/verlinde.henk"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/aeg-dev.github.io\/AegiSite\/"},{"@type":"ListItem","position":3,"name":"Docs","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/"},{"@type":"ListItem","position":4,"name":"3.2","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/"},{"@type":"ListItem","position":5,"name":"En","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/en\/"},{"@type":"ListItem","position":6,"name":"Automation","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/en\/automation\/"},{"@type":"ListItem","position":7,"name":"Lua","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/en\/automation\/lua\/"},{"@type":"ListItem","position":8,"name":"Miscellaneous Apis","item":"https:\/\/aeg-dev.github.io\/AegiSite\/\/docs\/3.2\/en\/automation\/lua\/miscellaneous_apis\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://aeg-dev.github.io/AegiSite/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aeg-dev.github.io/AegiSite/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aeg-dev.github.io/AegiSite/favicon-16x16.png><link rel=manifest href=https://aeg-dev.github.io/AegiSite/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://aeg-dev.github.io/AegiSite/>Aegisub</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/Aegisub/Aegisub><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2 text-nowrap"><li class=nav-item><a class=nav-link href=https://aeg-dev.github.io/AegiSite/downloads/main/>Downloads</a></li><li class="nav-item active"><a class=nav-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/main_page/>Docs</a></li><li class=nav-item><a class=nav-link href=https://github.com/Aegisub/Aegisub/issues>Bug Tracker</a></li><li class=nav-item><a class=nav-link href=https://aeg-dev.github.io/AegiSite/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=http://blog.aegisub.org/>Old News</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Navigation</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/main_page/>Main Page</a></li></ul><h3>Introduction</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/about/>What is Aegisub?</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/highlights/>Highlights</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/credits/>Credits</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/support/>Support Aegisub</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/faq/>FAQ</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/tutorials/>Tutorials</a></li></ul><h3>Working with Subtitles</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/editing_subtitles/>Editing Subtitles</a></li></ul><h3>Typesetting</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/typesetting/>Typesetting Introduction</a></li></ul><h3>Timing</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/audio/>Working with Audio</a></li></ul><h3>Automation</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/automation/>Overview</a></li></ul><h3>Miscellaneous</h3><ul class=list-unstyled><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/options/>Aegisub Options</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/properties/>Script Properties</a></li><li><a class=docs-link href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/attachment_manager/>Attachment Manager</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#aegisubcancel>aegisub.cancel</a></li><li><a href=#aegisubtext_extents>aegisub.text_extents</a></li><li><a href=#aegisubgettext>aegisub.gettext</a></li><li><a href=#getting-information-on-the-video>Getting information on the video</a><ul><li><a href=#aegisubframe_from_ms>aegisub.frame_from_ms</a></li><li><a href=#aegisubms_from_frame>aegisub.ms_from_frame</a></li><li><a href=#aegisubvideo_size>aegisub.video_size</a></li><li><a href=#aegisubkeyframes>aegisub.keyframes</a></li></ul></li><li><a href=#aegisubdecode_path>aegisub.decode_path</a></li><li><a href=#aegisubproject_properties>aegisub.project_properties</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1></h1><p class=lead></p><p>This page documents <strong>miscellaneous APIs useful for working with
subtitles</strong>. These can&rsquo;t be clearly placed into any of the other main
categories and there&rsquo;s too few of each kind to warrant a separate category.</p><h2 id=aegisubcancel>aegisub.cancel<a href=#aegisubcancel class=anchor aria-hidden=true>#</a></h2><p>Synopsis: <code>aegisub.cancel()</code></p><p>Immediately end execution of the current script, rolling back any changes
that have been made in it.</p><p>This function never returns.</p><h2 id=aegisubtext_extents>aegisub.text_extents<a href=#aegisubtext_extents class=anchor aria-hidden=true>#</a></h2><p>Synopsis: <code>width, height, descent, ext_lead = aegisub.text_extents(style, text)</code></p><p>Obtain system font metrics and determine the rendered size in pixels of the
given <strong>text</strong> when using the <strong>style</strong>.</p><dl><dt><strong><code>@style</code></strong> (<code>table</code>)</dt><dd>A [[style
table|Automation/Lua/Subtitle_file_interface#styletable]] as defined by
the subtitle interface. The font name, size, weight, style, spacing and
encoding is used to determine the size of the text.</dd><dt><strong><code>@text</code></strong> (<code>string</code>)</dt><dd>The text the extents should be determined for. This
should not contain line breaks (<code>\n</code> or <code>\r\n</code>) nor should it contain
formatting codes of any kind. Formatting codes are not interpreted and
will be taken as verbatim text.</dd><dt><strong><code>width</code></strong> (<code>number</code>)</dt><dd>Width in pixels of text. This may be non-integer.</dd><dt><strong><code>height</code></strong> (<code>number</code>)</dt><dd>Height in pixels of the text. This may be non-integer.</dd><dt><strong><code>descent</code></strong> (<code>number</code>)</dt><dd>Length of descenders in the font. This may be
non-integer.</dd><dt><strong><code>ext_lead</code></strong> (<code>number</code>)</dt><dd>External leading for the font. This may be non-integer.</dd></dl><p>You should only feed plain text strings without line breaks into this
function. It cannot handle any kind of formatting codes or text layout.
Rather, it is intended as a helper to create text layouts by determining
rendered sizes of bits and pieces of a longer text, which can then be
laid out by the script.</p><h2 id=aegisubgettext>aegisub.gettext<a href=#aegisubgettext class=anchor aria-hidden=true>#</a></h2><p>Synopsis: <code>translation = aegisub.gettext(untranslated)</code></p><p>Get the translation for a string. This is mostly only intended for scripts
bundled with Aegisub (as there&rsquo;s no way for you to add your own
translations), but if you happen to be using strings that are present in
Aegisub it may be useful.</p><p>Note that in the bundled macros this is always aliased to <code>tr</code> for the sake
of the string extractor.</p><h2 id=getting-information-on-the-video>Getting information on the video<a href=#getting-information-on-the-video class=anchor aria-hidden=true>#</a></h2><p>Automation 4 Lua offers two functions designed to be able to work with
frame-based timing without having to consider whether the video source is
VFR or CFR.</p><p>The primary purpose of these functions is to be able to generate per-frame
effects, i.e. get the timestamps of a number of sequential frames and
calculate coordinates, sizes etc. for an object for each of those frames.</p><p>One thing to remember when using these functions is that, considering a
one-dimensional time line, a time stamp is a point on the time line, while
a video frame spans a range of the time line, from its beginning time to
its ending time. The ending time of a frame is the beginning time of the
next. The beginning time of a frame is included in the range while the
ending time is excluded from the range.</p><h3 id=aegisubframe_from_ms>aegisub.frame_from_ms<a href=#aegisubframe_from_ms class=anchor aria-hidden=true>#</a></h3><p>Synopsis: <code>frame = aegisub.frame_from_ms(ms)</code></p><p>Use loaded frame rate data to convert an absolute time given in
<strong>milliseconds</strong> into a <strong>frame</strong> number.</p><dl><dt><strong><code>@ms</code></strong> (<code>number</code>)</dt><dd>Absolute time from the beginning of the video, for
which to determine the frame number.</dd><dt><strong><code>frame</code></strong> (<code>number</code>)</dt><dd>Frame number corresponding to the time in ms, or <code>nil</code> if there is no
frame rate data loaded.</dd></dl><p>If the time is in the middle of the frame it is <strong>rounded down</strong> to the frame
number that contains the given time.</p><h3 id=aegisubms_from_frame>aegisub.ms_from_frame<a href=#aegisubms_from_frame class=anchor aria-hidden=true>#</a></h3><p>Synopsis: <code>ms = aegisub.ms_from_frame(frame)</code></p><p>Use loaded frame rate data to convert a <strong>frame</strong> number of the video into
an absolute time in <strong>milliseconds</strong>.</p><dl><dt><strong><code>@frame</code></strong> (<code>number</code>)</dt><dd>Frame to obtain the beginning time of.</dd><dt><strong><code>ms</code></strong> (<code>number</code>)</dt><dd>First integer millisecond time stamp to lie within the frame, or <code>nil</code> if
there is no frame rate data loaded.</dd></dl><p>Because beginning times of frames can have better precision than one
millisecond this function rounds up and returns the first whole millisecond
that is guaranteed to be within the frame.</p><h3 id=aegisubvideo_size>aegisub.video_size<a href=#aegisubvideo_size class=anchor aria-hidden=true>#</a></h3><p>Synopsis: <code>xres, yres, ar, artype = aegisub.video_size()</code></p><p>Get information about the resolution and aspect-ratio of the loaded video,
if any.</p><dl><dt><strong><code>xres</code></strong> (<code>number</code>)</dt><dd>Coded width of the video in pixels, or <code>nil</code> if there is no video loaded.</dd><dt><strong><code>yres</code></strong> (<code>number</code>)</dt><dd>Coded height of the video in pixels, or <code>nil</code> if there is no video loaded.</dd><dt><strong><code>ar</code></strong> (<code>number</code>)</dt><dd>Custom display aspect ratio override. Meaningless unless <code>artype</code> is 4.</dd><dt><strong><code>artype</code></strong> (<code>number</code>)</dt><dd>There are 5 values that <code>artype</code> can take:<ul><li>0: The video has square pixels, i.e. PAR is 1.00 and DAR is <code>xres</code>/<code>yres</code>.</li><li>1: The video is 4:3, i.e. DAR is 1.33.</li><li>2: The video is 16:9, i.e. DAR is 1.78.</li><li>3: The video is 2.35 format, i.e. DAR is 2.35.</li><li>4: The DAR is whatever the <code>ar</code> return value contains.</li></ul></dd></dl><h3 id=aegisubkeyframes>aegisub.keyframes<a href=#aegisubkeyframes class=anchor aria-hidden=true>#</a></h3><p>Synopsis <code>keyframes = aegisub.keyframes()</code></p><p>Get a list of what video frames are keyframes.</p><dl><dt><strong><code>keyframes</code></strong> (<code>table</code>)</dt><dd>A sorted table where each entry is the frame number of a keyframe. If
no keyframe data is loaded, the table will be empty.</dd></dl><h2 id=aegisubdecode_path>aegisub.decode_path<a href=#aegisubdecode_path class=anchor aria-hidden=true>#</a></h2><p>Synopsis <code>path = aegisub.decode_path(encoded_path)</code></p><p>Convert a path beginning with a [[path specifier|Aegisub_path_specifiers]]
to an absolute path.</p><dl><dt><strong><code>@encoded_path</code></strong> (<code>string</code>)</dt><dd>A string which may optionally begin with an Aegisub [[path specifier|Aegisub_path_specifiers]].</dd><dt><strong><code>@path</code></strong> (<code>string</code>)</dt><dd>If <code>encoded_path</code> began with a valid [[path
specifier|Aegisub_path_specifiers]], an absolute path. If it began with an
invalid path specifier (such as if ?video was used when no video is open),
a string that is unlikely to be useful in any way. Any other strings are
passed through untouched.</dd></dl><h2 id=aegisubproject_properties>aegisub.project_properties<a href=#aegisubproject_properties class=anchor aria-hidden=true>#</a></h2><p>Synopsis <code>properties = aegisub.project_properties()</code></p><p>Get a table containing information about what files the user currently has open.
The exact contents of this table are deliberately undocumented, and may change without warning.</p><p>{::template name=&ldquo;automation_navbox&rdquo; /}</p><div class="docs-navigation d-flex justify-content-between"><a href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/automation/lua/dialogs/><div class="card my-1"><div class="card-body py-2">&larr;</div></div></a><a class=ms-auto href=https://aeg-dev.github.io/AegiSite/docs/3.2/en/automation/lua/modules/><div class="card my-1"><div class="card-body py-2">&rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://www.networkredux.com/>NetworkRedux</a>, <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=https://aeg-dev.github.io/AegiSite/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=https://aeg-dev.github.io/AegiSite/js/highlight.min.23f16da133548e29aa8de3077755353b92ab613aeb6543a7f26b0e897536bde8c6fe45e68ef6d13d6de184f6b7199e781aaebd156dbcaacd50e849b8b2ec0991.js integrity="sha512-I/FtoTNUjimqjeMHd1U1O5KrYTrrZUOn8msOiXU2vejG/kXmjvbRPW3hhPa3GZ54Gq69FW28qs1Q6Em4suwJkQ==" crossorigin=anonymous defer></script><script src=https://aeg-dev.github.io/AegiSite/main.min.cb1cfa565384689404329cbf8ad4a175b59ac6421a528ad947882d8242fc7b62b773cd5967a10349256154f6a67bcdeeb3da0729191ddd4f5623442999e53004.js integrity="sha512-yxz6VlOEaJQEMpy/itShdbWaxkIaUorZR4gtgkL8e2K3c81ZZ6EDSSVhVPame83us9oHKRkd3U9WI0QpmeUwBA==" crossorigin=anonymous defer></script><script src=https://aeg-dev.github.io/AegiSite/index.min.3cb45224a0dba2c3a14767bedce22c2898e358b9c00aed2f5ffcfb2c877db05acc5e34ccda5a45970faeed72714eb9574276f11c9f05e2d382af99f4ac22096a.js integrity="sha512-PLRSJKDbosOhR2e+3OIsKJjjWLnACu0vX/z7LId9sFrMXjTM2lpFlw+u7XJxTrlXQnbxHJ8F4tOCr5n0rCIJag==" crossorigin=anonymous defer></script></body></html>